var documenterSearchIndex = {"docs":
[{"location":"","page":"Home","title":"Home","text":"Photosynthesis","category":"page"},{"location":"#Photosynthesis","page":"Home","title":"Photosynthesis","text":"Photosynthesis\n\n(Image: ) (Image: Build Status) (Image: codecov.io)\n\nA Farquhar-von-Cammerer-Berry (FvCB) photosynthesis modelling framework.\n\nThis module at its core is a rewrite of the Maespa/Maestra/ models in Julia. It has been written to have a modular structure that can be easily modified or added to at any level. It is also designed to itself be a component of larger model.\n\nIt aims to provide a comprehensive yet minimalist set of photosynthesis and leaf energy balance models, eventually including as many as possible published photosynthesis formulations: but nothing else. Growth models, 3D canopy models, nutrient uptake etc. should be supplied from another package.\n\nIncluded formulations of the basic FvCB model include Ball-Berry (and multiple sub-variants), EMAX, Tuzet, and Jarvis.\n\nExample\n\nHere we will define a basic Ball-Berry model, and run it:\n\nparams = FvCBEnergyBalance(\n    photosynthesis_model=FvCBPhotosynthesis(\n        stomatal_conductance=BallBerryStomatalConductance(\n            gs_submodel=BallBerryStomatalConductance(),\n            soil_model=NoSoilMethod()\n        ),\n        flux_model=DukeFlux(),\n        compensation_model=BadgerCollatzCompensation()\n    )\n)\nvars = BallBerryVars()\n\nenbal!(vars, params)\n\nNotice we run enbal! not photosynthesis!, as enbal! runs photosynthesis! in a loop to calculate both the temperature and the assimilated C.\n\nNotes about strategies used in this package\n\nThis package was intentionally written as an exploration of how process model components could generally be structured in better ways to traditional models - to reduce the overheads of making small changes to any part of the model and improve the potential for collaboration. This method also facilitates composing formulations from multiple packages into new models without having to change the codebases. Some of the structural ideas seem promising, others may need rethinking.\n\nUnits\n\nThis implementation takes advantage of Unitful.jl to provide unit checking and conversion. This removes the possibility of a large class of errors, especially when adding your own custom formulations, and has little or no runtime cost in most cases\n\nNested parameters\n\nParameters are composed of nested structs, so that components can be modified and new components can be added without altering the original. This structure should be liberating for those wanting to make modifications to existing formulations.\n\nFormulations all follow the pattern of defining an abstract type and a function at the top of the file. All formulation variants inherit from the abstract type, and define a method of the function.\n\nThis allows easy addition of any model components without altering the package code.\n\nTo convert model parameters to a vector for optimisation or interactive interfaces, Flatten.jl can be used.\n\nFieldMetadata.jl allows adding other metadata to parameters (all the | XX | in struct definitions), such as descriptions, defaults, units and bounds. These can also be flattened with Flatten.jl for used in an optimiser or interface without writing any custom code.\n\nOther tools like the (unpublished) Codify.jl turns a nested model struct into the code for kwarg constructors that would build it. \n\nIssues\n\nTests\n\nCurrently this package has no real tests, as there were none for the original Fortran. Instead it tests against the original formulations. Many of these test pass, but some still don't.\n\nObviously this situation needs to change. Unit tests and comprehensive integration tests are required. But is a significant amount of work and it would need a more specific application and larger user base to be justifiable.\n\nNon-functional variable struct\n\nTemp variables are written directly to a variables struct. This should be replaced with a functional style where variables are rebuilt and explicitly updated. This would mean that the package can be used on GPUs, and so the updating of state flow is easier to follow.\n\nCredits\n\nThanks got to the creators of the Maestra Fortran libraries including Belinda Medlyn and Remko Duursma, and all earlier contributors to Maestra and Maestro.\n\n\n\n\n\n","category":"module"},{"location":"#Energy-balance-model","page":"Home","title":"Energy balance model","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Photosynthesis.AbstractEnergyBalance\nPhotosynthesis.AbstractFvCBEnergyBalance\nFvCBEnergyBalance\nenbal!\nPhotosynthesis.enbal_init!\nPhotosynthesis.enbal_update!","category":"page"},{"location":"#Photosynthesis.AbstractEnergyBalance","page":"Home","title":"Photosynthesis.AbstractEnergyBalance","text":"Energy balance models\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.AbstractFvCBEnergyBalance","page":"Home","title":"Photosynthesis.AbstractFvCBEnergyBalance","text":"Energy balance models based on genral FvCB photosynthesis, derived from Maespa/Maestra models.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.FvCBEnergyBalance","page":"Home","title":"Photosynthesis.FvCBEnergyBalance","text":"FvCBEnergyBalance(radiation_conductance, \n                  boundary_conductance, \n                  decoupling, \n                  evapotranspiration, \n                  photosynthesis, \n                  max_itererations)\n\nEnergy-balance model composed of submodels from radiation conductance,  boundary conductance, decoupling, evapotranspiration photosynthesis.\n\nmax_itererations determines the maximum number of iterations to perform to determine  flux and temperature.\n\nField Default Units Description\nradiationconductancemodel WangRadiationConductance{Float64}(1.0, 1 1 \nboundaryconductancemodel BoundaryConductance{Unitful.Quantity{Flo 1 \ndecoupling_model McNaughtonJarvisDecoupling() 1 \nevapotranspiration_model PenmanMonteithEvapotranspiration() 1 \nphotosynthesis_model FvCBPhotosynthesis{PotentialModifiedFlux 1 \nmax_itererations 100 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.enbal!","page":"Home","title":"Photosynthesis.enbal!","text":"enbal!(v, p)\n\nThis subroutine calculates leaf photosynthesis and transpiration.\n\nThese may be calculated by: (1) assuming leaf temperature = air temperature, cs = ca and ds = da (2) using iterative scheme of Leuning et al (1995) (PCE 18:1183-1200) to calculate leaf temp, CsCa.\n\nSetting maxiterations = 0 gives (1); maxiterations > 0 (suggest 100) gives (2).\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.enbal_init!","page":"Home","title":"Photosynthesis.enbal_init!","text":"model_init!(v, f)\n\nRuns any model initialisation that needs to happen at the start of energy balance\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.enbal_update!","page":"Home","title":"Photosynthesis.enbal_update!","text":"model_update!(v, f, tleaf)\n\nRuns any model specific variable updates that need to happen at the end of the leaf temperature convergene loop\n\n\n\n\n\n","category":"function"},{"location":"#Model-variables","page":"Home","title":"Model variables","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"BallBerryVars","category":"page"},{"location":"#Photosynthesis.BallBerryVars","page":"Home","title":"Photosynthesis.BallBerryVars","text":"BallBerryVars(tair, windspeed, par, rnet, soilmoist, pressure, tleaf, swp, swpshade, vpd, ca, rh,\n              cs, vpdleaf, rhleaf, fheat, gbhu, gbhf, gh, gbh, gv, gradn, lhv, et, slope, decoup,\n              gs_div_a, km, ci, gammastar, gs, gsv, gbv, jmax, vcmax, rd, ac, aleaf, vj, aj, fsoil)\n\nVariables for Ball-Berry stomatal conductance models.\n\nField Default Units Description\ncs 400.0 μmol mol^-1 \nvpdleaf 0.8 kPa \nrhleaf 0.99 1 Only in Ball-Berry Stomatal Conductance\nfheat 0.0 W m^-2 \ngbhu 0.0 m mol Pa J^-1 s^-1 \ngbhf 0.0 m mol Pa J^-1 s^-1 \ngh 0.0 m mol Pa J^-1 s^-1 \ngbh 0.0 m mol Pa J^-1 s^-1 \ngv 0.0 m mol Pa J^-1 s^-1 \ngradn 0.0 mol m^-2 s^-1 \nlhv 0.0 J mol^-1 \net 0.0 mol m^-2 s^-1 \nslope 0.0 Pa K^-1 \ndecoup 0.0 1 \ngsdiva 0.0 mol μmol^-1 \nkm 0.0 μmol mol^-1 \nci 0.0 μmol mol^-1 \ngammastar 0.0 μmol mol^-1 \ngs 0.0 mol m^-2 s^-1 \ngsv 0.0 mol m^-2 s^-1 \ngbv 0.0 mol m^-2 s^-1 \njmax 0.0 μmol m^-2 s^-1 \nvcmax 0.0 μmol m^-2 s^-1 \nrd 0.0 μmol m^-2 s^-1 \nac 0.0 μmol m^-2 s^-1 \naleaf 0.0 μmol m^-2 s^-1 \nvj 0.0 μmol m^-2 s^-1 \naj 0.0 μmol m^-2 s^-1 \nfsoil 0.0 1 \ntair 298.15 K \nwindspeed 1.0 m s^-1 \npar 1143.75 μmol m^-2 s^-1 \nrnet 250.0 W m^-2 \nsoilmoist 0.2 1 \npressure 101.25 kPa \ntleaf 298.15 K \nswp -100.0 kPa \nswpshade -100.0 kPa \nvpd 0.5 kPa \nca 400.0 μmol mol^-1 \nrh 0.5 1 \n\n\n\n\n\n","category":"type"},{"location":"#Biophysical-components","page":"Home","title":"Biophysical components","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Photosynthesis.saturated_vapour_pressure\nPhotosynthesis.vapour_pressure_deficit\nPhotosynthesis.latent_heat_water_vapour\nPhotosynthesis.penman_monteith\nPhotosynthesis.arrhenius\nPhotosynthesis.leaftemp","category":"page"},{"location":"#Photosynthesis.saturated_vapour_pressure","page":"Home","title":"Photosynthesis.saturated_vapour_pressure","text":"saturated_vapour_pressure(tair)\n\nCalculate saturated water vapour pressure in u\"Pa\"  at air temperature tair in u\"K\".\n\nFrom Jones 1992 p 110 (note error in a - wrong units)\n\nTODO: name the magic numbers\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.vapour_pressure_deficit","page":"Home","title":"Photosynthesis.vapour_pressure_deficit","text":"vapour_pressure_deficit(tair, rh)\n\nCalculate vapour pressure deficit given air temperature tair and relative humidity rh\n\nReturns a value in u\"kPa\"\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.latent_heat_water_vapour","page":"Home","title":"Photosynthesis.latent_heat_water_vapour","text":"latent_heat_water_vapour(tair)\n\nCaculates the late hear of water vapour from the air temperature.\n\nReturns a value in u\"K\".\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.penman_monteith","page":"Home","title":"Photosynthesis.penman_monteith","text":"penman_monteith(pressure, slope, lhv, rnet, vpd, gh, gv)\n\nThis subroutine calculates evapotranspiration by leaves using the Penman - Monteith equation.\n\nInputs:\n\nρ atmospheric pressure, Pa Δ slope of VPD / T curve, Pa K-1 lhv latent heat of water at air T, J mol-1 Rn net radiation, J m-2 s-1 Da vapour pressure deficit of air, Pa gh boundary layer conductance to heat (freeforcedradiative components), mol m-2 s-1 gv conductance to water vapour (stomatalbdry layer components), molm^-2s^-1\n\nResult in molm^-2s^-1\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.arrhenius","page":"Home","title":"Photosynthesis.arrhenius","text":"arrhenius(kref, Ea, T, Tref)\n\nThe Arrhenius function.\n\n-kref: is the value at Tref deg -Ea: the activation energy (j mol - 1) and  -T: the temp in °C or K -Tref: the reference temp in °C or K Standard form and temperature difference form.\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.leaftemp","page":"Home","title":"Photosynthesis.leaftemp","text":"leaftemp(p, v)\n\nCalculate the leaf temperature given variables v.\n\nReturns a value in u\"K\".\n\n\n\n\n\n","category":"function"},{"location":"#Boundary-conductance","page":"Home","title":"Boundary conductance","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractBoundaryConductance\nBoundaryConductance\nPhotosynthesis.boundary_conductance_free\nPhotosynthesis.boundary_conductance_forced\nPhotosynthesis.vapour_conductance! \nPhotosynthesis.grashof_number\nPhotosynthesis.cmolar\nPhotosynthesis.free_boundary_conductance\nPhotosynthesis.forced_boundary_conductance","category":"page"},{"location":"#Photosynthesis.AbstractBoundaryConductance","page":"Home","title":"Photosynthesis.AbstractBoundaryConductance","text":"Boundary conductance models.\n\nProvide parameters for vapour_conductance!, boundary_conductance_free,  and boundary_conductance_forced.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.BoundaryConductance","page":"Home","title":"Photosynthesis.BoundaryConductance","text":"BoundaryConductance(leafwidth, gsc)\nBoundaryConductance(; leafwidth=0.05u\"m\", gsc=1.0u\"mol*m^-2*s^-1\")\n\nStandard boundary conductance formulation parameters.\n\nField Default Units Description\nleafwidth 0.05 m Mean width of leaves\ngsc 1.0 mol m^-2 s^-1 Stomatal conductance of the boundary layer to CO₂\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.boundary_conductance_free","page":"Home","title":"Photosynthesis.boundary_conductance_free","text":"boundary_conductance_free(f::AbstractBoundaryConductance, v)\n\nBoundary layer conductance for heat - single sided, free convection, given variables v.\n\nRetuns conductance in u\"mol*m-2*s-1\".\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.boundary_conductance_forced","page":"Home","title":"Photosynthesis.boundary_conductance_forced","text":"boundary_conductance_forced(f::AbstractBoundaryConductance, v)\n\nBoundary layer conductance for heat - single sided, forced convection,  given variables v.\n\nRetuns conductance in u\"mol*m-2*s-1\".\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.vapour_conductance!","page":"Home","title":"Photosynthesis.vapour_conductance!","text":"vapour_conductance!(v, f::AbstractBoundaryConductance)\n\nVapour conductance.\n\nTODO remove assingments to v\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.grashof_number","page":"Home","title":"Photosynthesis.grashof_number","text":"grashof_number(Ts, Ta, d)\n\nCalculates the Grashof number given leaf temperature, air tempereature and leaf width.\n\nTs: Object temperature T: background temperature a: coefficient of thermal expansion.\n\nreturn: dimensionless\n\nSee Leuning et al (1995) PCE 18:1183-1200 Eqn E4\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.cmolar","page":"Home","title":"Photosynthesis.cmolar","text":"cmolar(ρ, Ta)\n\nConvert from ms^-1 to molm^-2*s^-1\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.free_boundary_conductance","page":"Home","title":"Photosynthesis.free_boundary_conductance","text":"boundary_conductance_free(α, Tl, Ta, w)\n\nLeaf boundary layer conductance for heat  - single sided, free convection  Dh is the molecular diffusivity to heat\n\nSee Leuning et al (1995) PCE 18:1183-1200 Eqn E3\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.forced_boundary_conductance","page":"Home","title":"Photosynthesis.forced_boundary_conductance","text":"boundary_conductance_forced(Ta, ρ, U, w)\n\nLeaf boundary layer conductance for heat - single sided, forced convection Ta is air temperature ρ is pressure U is wind speed w is leaf width\n\nSee Leuning et al (1995) PCE 18:1183-1200 Eqn E1\n\n\n\n\n\n","category":"function"},{"location":"#Canopy-atmosphere-decoupling","page":"Home","title":"Canopy-atmosphere decoupling","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractDecoupling\nMcNaughtonJarvisDecoupling\nNoDecoupling\nPhotosynthesis.decoupling","category":"page"},{"location":"#Photosynthesis.AbstractDecoupling","page":"Home","title":"Photosynthesis.AbstractDecoupling","text":"Canopy-atmospheric decoupling models,  calculated in decoupling method.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.McNaughtonJarvisDecoupling","page":"Home","title":"Photosynthesis.McNaughtonJarvisDecoupling","text":"McNaughtonJarvisDecoupling()\n\nCalculate decoupling coefficient following McNaughton and Jarvis 1986\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.NoDecoupling","page":"Home","title":"Photosynthesis.NoDecoupling","text":"NoDecoupling()\n\nDon't calculate decoupling.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.decoupling","page":"Home","title":"Photosynthesis.decoupling","text":"decoupling(f::AbstractDecoupling, v)\n\nCalculate decoupling, returning a float between 0.0 and 1.0.\n\n\n\n\n\n","category":"function"},{"location":"#Evapotranspiration","page":"Home","title":"Evapotranspiration","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractEvapotranspiration \nPenmanMonteithEvapotranspiration\nPhotosynthesis.evapotranspiration\nPhotosynthesis.penman_monteith(ρa, Δ, lhv, Rn, Da, gh, gv)\nPhotosynthesis.slope","category":"page"},{"location":"#Photosynthesis.AbstractEvapotranspiration","page":"Home","title":"Photosynthesis.AbstractEvapotranspiration","text":"Evapotranspiration models, define an evapotranspiration method.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.PenmanMonteithEvapotranspiration","page":"Home","title":"Photosynthesis.PenmanMonteithEvapotranspiration","text":"PenmanMonteithEvapotranspiration()\n\nPenman-Monteith evapotranspiration model\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.evapotranspiration","page":"Home","title":"Photosynthesis.evapotranspiration","text":"evapotranspiration(f::AbstractEvapotranspiration, v)\n\nCalculate the rate of evapotranspiration in u\"molm^-2s^-1\".\n\nWhere v is a variables object.\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.penman_monteith-NTuple{7,Any}","page":"Home","title":"Photosynthesis.penman_monteith","text":"penman_monteith(pressure, slope, lhv, rnet, vpd, gh, gv)\n\nThis subroutine calculates evapotranspiration by leaves using the Penman - Monteith equation.\n\nInputs:\n\nρ atmospheric pressure, Pa Δ slope of VPD / T curve, Pa K-1 lhv latent heat of water at air T, J mol-1 Rn net radiation, J m-2 s-1 Da vapour pressure deficit of air, Pa gh boundary layer conductance to heat (freeforcedradiative components), mol m-2 s-1 gv conductance to water vapour (stomatalbdry layer components), molm^-2s^-1\n\nResult in molm^-2s^-1\n\n\n\n\n\n","category":"method"},{"location":"#Photosynthesis.slope","page":"Home","title":"Photosynthesis.slope","text":"slope(tair)\n\nCalculate vapour pressure change with temperature - Slope s for Penman-Monteith equation, in Pa K^-1\n\nthis is somewhat expensive with two calls to exp(), so it is good to precalculate instead of repeating\n\n\n\n\n\n","category":"function"},{"location":"#Radiation-conductance","page":"Home","title":"Radiation conductance","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractRadiationConductance\nWangRadiationConductance\nradiation_conductance\nwang_radiation_conductance","category":"page"},{"location":"#Photosynthesis.AbstractRadiationConductance","page":"Home","title":"Photosynthesis.AbstractRadiationConductance","text":"Radiation conductance models, run in radiation_conductance.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.WangRadiationConductance","page":"Home","title":"Photosynthesis.WangRadiationConductance","text":"WangRadiationConductance(rdfipt, tuipt, tdipt)\n\nReturns the \"radiation conductance\" at given temperature. Formula from Ying-Ping\"s version of Maestro.\n\nSee also Jones (1992) p. 108.0\n\nField Default Units Description\nrdfipt 1.0 1 Not documented in MAESPA\ntuipt 1.0 1 Not documented in MAESPA\ntdipt 1.0 1 Not documented in MAESPA\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.radiation_conductance","page":"Home","title":"Photosynthesis.radiation_conductance","text":"radiation_conductance(f::AbstractRadiationConductance, v)\n\nCalculates radiation conductance for formular f, given variable `v'.\n\nReturns quantity with units u\"mol*m^-2*s^-1\"\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.wang_radiation_conductance","page":"Home","title":"Photosynthesis.wang_radiation_conductance","text":"wang_radiation_conductance(tair, rdfipt, tuipt, tdipt)\n\nReturns the \"radiation conductance\" at given temperature. Formula from Ying-Ping Wang's version of Maestro.\n\nSee also Jones (1992) p. 108.0\n\nReturns quantity with units u\"mol*m^-2*s^-1\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis-model","page":"Home","title":"Photosynthesis model","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractPhotosynthesis\nAbstractFvCBPhotosynthesis\nFvCBPhotosynthesis\nphotosynthesis!","category":"page"},{"location":"#Photosynthesis.AbstractPhotosynthesis","page":"Home","title":"Photosynthesis.AbstractPhotosynthesis","text":"Abstract supertype for all photosynthesis models\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.AbstractFvCBPhotosynthesis","page":"Home","title":"Photosynthesis.AbstractFvCBPhotosynthesis","text":"Abstract supertype for all Farquhar/von Caemmerer/Berry derived photosynthesis models\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.FvCBPhotosynthesis","page":"Home","title":"Photosynthesis.FvCBPhotosynthesis","text":"FvCBPhotosynthesis(flux, compensation, rubisco_regen, respiration, stomatal_conductance)\n\nGeneral Farquhar von Caemmerer Berry model of photosynthesis. Organised as a modular components of electron flux, CO2 and rubusco compensation, rubisco regeneration,  respiration and stomatal conductance.\n\nCalculates photosynthesis according to the ECOCRAFT agreed formulation of the Farquharvon Caemmerer (1982) equations.\n\nFarquhar, G.D., S. Caemmerer and J.A. Berry. 1980. A biochemical model of photosynthetic CO2 assimilation in leaves of C3 species. Planta. 149:78-90.\n\nField Default Units Description\nflux_model PotentialModifiedFlux{Flux{Jmax{Unitful. 1 \ncompensation_model BernacchiCompensation{Unitful.Quantity{F 1 \nrubiscoregenmodel RubiscoRegen(0.4, 0.324) 1 \nrespiration_model Respiration{Unitful.Quantity{Float64,𝚯^- 1 \nstomatalconductancemodel BallBerryStomatalConductance{Unitful.Qua 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.photosynthesis!","page":"Home","title":"Photosynthesis.photosynthesis!","text":"photosynthesis!(vars, params::AbstractPhotosynthesis)\n\nRun a photosynthesis model, writing results to vars.\n\n\n\n\n\n","category":"function"},{"location":"#CO2-and-Rubisco-Compensation","page":"Home","title":"CO2 and Rubisco Compensation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Compensation\nBadgerCollatzCompensation\nBernacchiCompensation\nPhotosynthesis.co2_compensation_point\nPhotosynthesis.rubisco_compensation_point","category":"page"},{"location":"#Photosynthesis.Compensation","page":"Home","title":"Photosynthesis.Compensation","text":"Physiological constants for CO2 and rubisco compensation point formulations, calculated in the methods co2_compensation_point  and rubisco_compensation_point respectively.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.BadgerCollatzCompensation","page":"Home","title":"Photosynthesis.BadgerCollatzCompensation","text":"BadgerCollatzCompensation(Kc25, Ko25, ΔHa_Kc, ΔHa_Ko, tref)\n\nParameters to calculate co2 and rubisco compensation  points using the Badger-Collatz formulation.\n\nField Default Units Description\nKc25 404.0 μmol mol^-1 MM coefft of Rubisco for CO2\nKo25 248000.0 μmol mol^-1 MM coefft of Rubisco for O2\nΔHa_Kc 59.4 kJ mol^-1 Temp. response of Kc\nΔHa_Ko 36.0 kJ mol^-1 Temp. response of Ko\ntref 298.15 K Temperature reference, usually 25.0° C\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.BernacchiCompensation","page":"Home","title":"Photosynthesis.BernacchiCompensation","text":"BernacchiCompensation(Kc25, Ko25, Γ☆25, ΔHa_Kc, ΔHa_Ko, ΔHa_Γ☆, tref)\n\nParameters to calculate CO2 and Rubisco compensation points using the  formulation from Bernacchi et al 2001, PCE 24: 253-260. \n\nNote: Extra deactivation terms may be required above 40°C.\n\nField Default Units Description\nKc25 404.9 μmol mol^-1 MM coefft of Rubisco for CO2\nKo25 278400.0 μmol mol^-1 MM coefft of Rubisco for O2\nΓ☆25 42.75 μmol mol^-1 \nΔHa_Kc 79.43 kJ mol^-1 Temp. response of Kc\nΔHa_Ko 36.38 kJ mol^-1 Temp. response of Ko\nΔHa_Γ☆ 37.83 kJ mol^-1 \ntref 298.15 K \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.co2_compensation_point","page":"Home","title":"Photosynthesis.co2_compensation_point","text":"co2_compensation_point(formulation::Compensation, vars)\n\nCalculates Γ*, or the CO2 compensation point in the absence of non-photorespiratory respiration.\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.rubisco_compensation_point","page":"Home","title":"Photosynthesis.rubisco_compensation_point","text":"rubisco_compensation_point(f::Compensation, tleaf)\n\nCalculates Km, or the effective Michaelis-Menten coefficient of Rubisco activity.\n\n\n\n\n\n","category":"function"},{"location":"#Flux","page":"Home","title":"Flux","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractFlux\nFlux\nDukeFlux\nPotentialModifiedFlux\nPhotosynthesis.flux","category":"page"},{"location":"#Photosynthesis.AbstractFlux","page":"Home","title":"Photosynthesis.AbstractFlux","text":"Abstract supertype for flux models.\n\nElectron flux Jmax and Rubisco activity Vcmax are often modified  by the same function, so we group them.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.Flux","page":"Home","title":"Photosynthesis.Flux","text":"Flux(jmaxformulation, vcmaxformulation)\n\nFormulation grouping jmax and vcmax formultions\n\nField Default Units Description\njmaxformulation Jmax{Unitful.Quantity{Float64,𝐍 𝐋^-2 𝐓^- 1 \nvcmaxformulation NoOptimumVcmax{Unitful.Quantity{Float64, 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.DukeFlux","page":"Home","title":"Photosynthesis.DukeFlux","text":"DukeFlux(flux_model, tvjup, tvjdn)\n\nFlux model modified that allow Jmax and Vcmax to be forced linearly to zero at low T.\n\nField Default Units Description\nflux_model Flux{Jmax{Unitful.Quantity{Float64,𝐍 𝐋^- 1 \ntvjup 283.15 K \ntvjdn 273.15 K \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.PotentialModifiedFlux","page":"Home","title":"Photosynthesis.PotentialModifiedFlux","text":"PotentialModifiedFlux(flux, potential_model)\n\nFlux model modified by non-stomatal potential dependence.\n\nMdifying both electron flux and rubisco activity by the result of  non_stomatal_potential_dependence for potential_model.\n\nField Default Units Description\nflux_model Flux{Jmax{Unitful.Quantity{Float64,𝐍 𝐋^- 1 \npotential_model ZhouPotentialDependence{Unitful.Quantity 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.flux","page":"Home","title":"Photosynthesis.flux","text":"flux(f::AbstractFlux, v)\n\nRun jamax and vcmax formulations and any modifications, returning a 2-tuple\n\n\n\n\n\n","category":"function"},{"location":"#Electron-transport-rate","page":"Home","title":"Electron transport rate","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractJmax\nJmax\nPhotosynthesis.max_electron_transport_rate","category":"page"},{"location":"#Photosynthesis.AbstractJmax","page":"Home","title":"Photosynthesis.AbstractJmax","text":"Electron flux formulation, calculated in max_electron_transport_rate.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.Jmax","page":"Home","title":"Photosynthesis.Jmax","text":"Jmax(jmax25, delsj, eavj, edvj)\n\nStandard formulation for maximum electron transport rate.\n\nField Default Units Description\njmax25 184.0 μmol m^-2 s^-1 Maximum rate of electron transport at 25° C\ndelsj 640.02 J K^-1 mol^-1 DELTAS in Medlyn et al. (2002)\neavj 37259.0 J mol^-1 Ha in Medlyn et al. (2002)\nedvj 200000.0 J mol^-1 Hd in Medlyn et al. (2002)\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.max_electron_transport_rate","page":"Home","title":"Photosynthesis.max_electron_transport_rate","text":"max_electron_transport_rate(f::Jmax, tleaf)\n\nCalculates the potential max_electron transport rate (Jmax) at the leaf temperature\n\n\n\n\n\n","category":"function"},{"location":"#Rubisco-activity","page":"Home","title":"Rubisco activity","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractVcmax\nOptimumVcmax\nNoOptimumVcmax\nPhotosynthesis.max_rubisco_activity","category":"page"},{"location":"#Photosynthesis.AbstractVcmax","page":"Home","title":"Photosynthesis.AbstractVcmax","text":"Maximum rubisco activity formulations,  calculated in max_rubisco_activity.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.OptimumVcmax","page":"Home","title":"Photosynthesis.OptimumVcmax","text":"OptimumVcmax(edvc, delsc, vcmax25, eavc)\n\nFormulation for maximum Rubisco activity with an optimum.\n\nField Default Units Description\nedvc 1.0 J mol^-1 Hd in Medlyn et al. (2002)\ndelsc 629.26 J K^-1 mol^-1 DELTAS in Medlyn et al. (2002)\nvcmax25 110.0 μmol m^-2 s^-1 Maximumrate rate of rubisco activity at 25° C\neavc 47590.0 J mol^-1 Ha Medlyn et al. (2002)\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.NoOptimumVcmax","page":"Home","title":"Photosynthesis.NoOptimumVcmax","text":"NoOptimumVcmax(vcmax25, eavc)\n\nFormulation for maximum Rubisco activity with no optimum.\n\nField Default Units Description\nvcmax25 110.0 μmol m^-2 s^-1 Maximumrate rate of rubisco activity at 25° C\neavc 47590.0 J mol^-1 Ha Medlyn et al. (2002)\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.max_rubisco_activity","page":"Home","title":"Photosynthesis.max_rubisco_activity","text":"max_rubisco_activity(formulation::AbstractVcmax, tleaf)\n\nCalculates the maximum Rubisco activity (Vcmax) at the leaf temperature tleaf.\n\nThere is still disagreement as to whether this function has an optimum or not. Both versions here are well-behaved for tleaf < 0.0\n\n\n\n\n\n","category":"function"},{"location":"#Rubisco-regeneration","page":"Home","title":"Rubisco regeneration","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractRubiscoRegen\nRubiscoRegen\nPhotosynthesis.rubisco_regeneration","category":"page"},{"location":"#Photosynthesis.AbstractRubiscoRegen","page":"Home","title":"Photosynthesis.AbstractRubiscoRegen","text":"Rubisco regeneration models.  These are run in the rubisco_regeneration method.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.RubiscoRegen","page":"Home","title":"Photosynthesis.RubiscoRegen","text":"RubiscoRegen(theta, ajq)\n\nRubisco regeneration model. \n\nTODO: specify origin of formulation\n\nField Default Units Description\ntheta 0.4 1 Shape parameter of the non-rectangular hyperbola\najq 0.324 1 Quantum yield of electron transport\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.rubisco_regeneration","page":"Home","title":"Photosynthesis.rubisco_regeneration","text":"rubisco_regeneration(f::RubiscoRegen, v)\n\nReturns RuBP regeneration rate, in u\"umol*m-2*s-1\" for formulation f given variables v.\n\n\n\n\n\n","category":"function"},{"location":"#Respiration","page":"Home","title":"Respiration","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractRespiration\nRespiration\nAcclimatizedRespiration\nPhotosynthesis.respiration","category":"page"},{"location":"#Photosynthesis.AbstractRespiration","page":"Home","title":"Photosynthesis.AbstractRespiration","text":"Respiration models, run in a respiration method.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.Respiration","page":"Home","title":"Photosynthesis.Respiration","text":"Respiration(q10f, dayresp, rd0, tbelow, tref)\n\nStandard respiration model. Calculates respiration from temperature using a Q10 (exponential) formulation \n\nTODO: specify origin of formulation\n\nField Default Units Description\nq10f 0.67 K^-1 Logarithm of the Q10\ndayresp 1.0 1 Respiration in the light as fraction of that in the dark\nrd0 0.001 μmol m^-2 s^-1 Dark respiration at the reference temperature\ntbelow 173.15 K Temperature below which no respiration occurs\ntref 298.15 K Reference temperature at which rd0 was measured\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.AcclimatizedRespiration","page":"Home","title":"Photosynthesis.AcclimatizedRespiration","text":"AcclimatizedRespiration(k10f, tmove, q10f, dayresp, rd0, tbelow, tref)\n\nRespiration with acclimatization parameters k10f and tmove. \n\nTODO test this. The formulation appears to need a variable tmove,  not a parameter.\n\nField Default Units Description\nk10f 10.0 K^-1 \ntmove 10.0 K \nq10f 0.67 K^-1 Logarithm of the Q10\ndayresp 1.0 1 Respiration in the light as fraction of that in the dark\nrd0 0.001 μmol m^-2 s^-1 Dark respiration at the reference temperature\ntbelow 173.15 K Temperature below which no respiration occurs\ntref 298.15 K Reference temperature at which rd0 was measured\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.respiration","page":"Home","title":"Photosynthesis.respiration","text":"respiration(f::Union{Nothing,Respiration}, tleaf)\n\nRespiration for formulation f at temperature tleaf in u\"K\". Returns respiration in u\"μmol*m^-2*s^-1\".\n\n\n\n\n\n","category":"function"},{"location":"#Non-stomatal-soil-water-potential-dependence","page":"Home","title":"Non-stomatal soil water-potential dependence","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractPotentialDependence\nLinearPotentialDependence\nZhouPotentialDependence\nNoPotentialDependence\nPhotosynthesis.non_stomatal_potential_dependence","category":"page"},{"location":"#Photosynthesis.AbstractPotentialDependence","page":"Home","title":"Photosynthesis.AbstractPotentialDependence","text":"Models for non-stomatal dependence of of vcmax and jmax on soil water  potential. Calculated in non_stomatal_potential_dependence.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.LinearPotentialDependence","page":"Home","title":"Photosynthesis.LinearPotentialDependence","text":"LinearPotentialDependence(vpara, vparb)\n\nSimple linear dependance. vpara is the swp where vcmax and  jmax are set to zero, while at vparb fluxes are at their maximum rate.\n\nField Default Units Description\nvpara -300.0 kPa \nvparb -100.0 kPa \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.ZhouPotentialDependence","page":"Home","title":"Photosynthesis.ZhouPotentialDependence","text":"ZhouPotentialDependence(s, ψ)\n\nParameters following Zhou, et al. Agricultural and Forest Meteorology, 2013.\n\nField Default Units Description\ns 2.0 MPa^-1 Sensitivity parameter indicating the steepness of the decline\nψ -1.0 MPa The water potential at which f(Ψpd) decreases to half of its maximum value\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.NoPotentialDependence","page":"Home","title":"Photosynthesis.NoPotentialDependence","text":"NoPotentialDependence()\n\nParameterless model where soil moisture has no non-stomatal effects.\n\nSimply returns 1\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.non_stomatal_potential_dependence","page":"Home","title":"Photosynthesis.non_stomatal_potential_dependence","text":"non_stomatal_potential_dependence(f::AbstractPotentialDependence, swp)\n\nCalculate dependence on soil water potential outside of stomatal effects.\n\nReturns a value between 0.0 and 1.0\n\n\n\n\n\n","category":"function"},{"location":"#Stomatal-conductance-models","page":"Home","title":"Stomatal conductance models","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractStomatalConductance\nAbstractBallBerryStomatalConductance\nBallBerryStomatalConductance\nPhotosynthesis.stomatal_conductance!\nPhotosynthesis.rubisco_limited_rate\nPhotosynthesis.transport_limited_rate\nPhotosynthesis.gs_init!\nPhotosynthesis.gs_update!\nPhotosynthesis.check_extremes!\nPhotosynthesis.update_extremes!","category":"page"},{"location":"#Photosynthesis.AbstractStomatalConductance","page":"Home","title":"Photosynthesis.AbstractStomatalConductance","text":"Stomatal conductance models\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.AbstractBallBerryStomatalConductance","page":"Home","title":"Photosynthesis.AbstractBallBerryStomatalConductance","text":"Ball-Berry implementation of stomatal conductance. Most other models inherit fields and behaviours from this.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.BallBerryStomatalConductance","page":"Home","title":"Photosynthesis.BallBerryStomatalConductance","text":"BallBerryStomatalConductance(g0, gs_submodel, soil_model)\n\nSimple Ball-Berry stomatal conductance model.\n\nField Default Units Description\ng0 0.03 mol m^-2 s^-1 Stomatal leakiness (gs when photosynthesis is zero)\ngs_submodel BallBerryStomatalConductanceSubModel{Uni 1 \nsoil_model PotentialSoilMethod{Unitful.Quantity{Flo 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.stomatal_conductance!","page":"Home","title":"Photosynthesis.stomatal_conductance!","text":"stomatal_conductance!(v, p)\n\nStomatal conductance and intercellular CO2 partial pressure calculations.\n\nv.aleaf is NET leaf photosynthesis.\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.rubisco_limited_rate","page":"Home","title":"Photosynthesis.rubisco_limited_rate","text":"rubisco_limited_rate(m::AbstractStomatalConductance, v, gs_div_a)\n\nRubisco limited rate of assimilation.\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.transport_limited_rate","page":"Home","title":"Photosynthesis.transport_limited_rate","text":"transport_limited_rate(m::AbstractStomatalConductance, v, gs_div_a)\n\nTransport limited rate of assimilation.\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.gs_init!","page":"Home","title":"Photosynthesis.gs_init!","text":"photo_init!(vars, params::AbstractStomatalConductance)\n\nInitialise variables based on the AbstractStomatalConductance model. \n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.gs_update!","page":"Home","title":"Photosynthesis.gs_update!","text":"photo_update!(vars, params::AbstractStomatalConductance)\n\nUpdate variables based on the model. \n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.check_extremes!","page":"Home","title":"Photosynthesis.check_extremes!","text":"check_extremes!(v, p::AbstractFvCBPhotosynthesis)\n\nCheck extreme values are in tolerable ranges\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.update_extremes!","page":"Home","title":"Photosynthesis.update_extremes!","text":"update_extremes!(v, m::AbstractStomatalConductance)\n\nUpdate variables in extreme conditions.\n\n\n\n\n\n","category":"function"},{"location":"#Stomatal-conductance-sub-models","page":"Home","title":"Stomatal conductance sub-models","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractStomatalConductanceSubModel\nAbstractBallBerryStomatalConductanceSubModel\nBallBerryStomatalConductanceSubModel\nLeuningStomatalConductanceSubModel\nMedlynStomatalConductanceSubModel\nPhotosynthesis.gs_div_a","category":"page"},{"location":"#Photosynthesis.AbstractStomatalConductanceSubModel","page":"Home","title":"Photosynthesis.AbstractStomatalConductanceSubModel","text":"Stomatal conductance submodels\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.AbstractBallBerryStomatalConductanceSubModel","page":"Home","title":"Photosynthesis.AbstractBallBerryStomatalConductanceSubModel","text":"Stomatal conductance submodels.\n\nMany stomatal conductance formulations are identical to Ball-Berry,  with changes only to this submodel.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.BallBerryStomatalConductanceSubModel","page":"Home","title":"Photosynthesis.BallBerryStomatalConductanceSubModel","text":"BallBerryStomatalConductanceSubModel(gamma, g1)\n\nBasic Ball-Berry stomatal conductance formulation.  Parameters are gamma in μmol*mol^-1 and g1 scalar,  which are also used for all Ball-Berry type models.\n\n(modelgs = 2 in maestra)\n\nField Default Units Description\ngamma 0.0 μmol mol^-1 Gamma for all Ball-Berry type models\ng1 7.0 1 Slope parameter\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.LeuningStomatalConductanceSubModel","page":"Home","title":"Photosynthesis.LeuningStomatalConductanceSubModel","text":"LeuningStomatalConductanceSubModel(d0l, gamma, g1)\n\nLeuning stomatal conductance formulation with extra d0l paramater.\n\nFrom R. Leuning, A critical appraisal of a combined stomatal-photosynthesis model for C3 plants. Plant, Celt and Environment (1995) 18, 339-355\n\nField Default Units Description\nd0l 1500.0 Pa \ngamma 0.0 μmol mol^-1 Gamma for all Ball-Berry type models\ng1 7.0 1 Slope parameter\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.MedlynStomatalConductanceSubModel","page":"Home","title":"Photosynthesis.MedlynStomatalConductanceSubModel","text":"MedlynStomatalConductanceSubModel(vpdmin, gk, gamma, g1)\n\nMedlyn stomatal conductance formulation parameters Has the extra vpdmin paramater in Pa. (modelgs = 4 in maestra)\n\nField Default Units Description\nvpdmin 1500.0 kPa \ngk 0.3 1 \ngamma 0.0 μmol mol^-1 Gamma for all Ball-Berry type models\ng1 7.0 1 Slope parameter\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.gs_div_a","page":"Home","title":"Photosynthesis.gs_div_a","text":"gs_div_a(m::AbstractStomatalConductanceSubModel, v)\n\nReturns the value of stomatal conductance gs divided by  assimilation a for sub-model m given variables v.\n\n\n\n\n\n","category":"function"},{"location":"#Stomatal-conductance-shape","page":"Home","title":"Stomatal conductance shape","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"StomatalConductanceShape \nHardMinimum \nHyperbolicMinimum\nPhotosynthesis.shape_gs","category":"page"},{"location":"#Photosynthesis.StomatalConductanceShape","page":"Home","title":"Photosynthesis.StomatalConductanceShape","text":"Determines the shape of stomatal conductance as it approaches zero, run in shape_gs method.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.HardMinimum","page":"Home","title":"Photosynthesis.HardMinimum","text":"HardMinimum()\n\nReturn stomatal conductance value that abrutly switches to the minimum value g0.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.HyperbolicMinimum","page":"Home","title":"Photosynthesis.HyperbolicMinimum","text":"HyperbolicMinimum()\n\nReturn stomatal conductance value that switches to the minimum value g0 using a hyperbolic curve, used for optimization to avoid discontinuity.  hmshape determines how smooth the transition is.\n\nField Default Units Description\nhmshape 0.999 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.shape_gs","page":"Home","title":"Photosynthesis.shape_gs","text":"shape_gs(f::StomatalConductanceShape, v, p)\n\nFunction to determine the hyperbolic minimum shape, for a formulation f in StomatalConductanceShape, fiven variables v and stomatal conductance parameters p.\n\nReturns the stomatal conductance gs in u\"mol*m^-2*s^-1\".\n\n\n\n\n\n","category":"function"},{"location":"#Stomatal-soil-water-dependence","page":"Home","title":"Stomatal soil water dependence","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"AbstractSoilMethod\nVolumetricSoilMethod\nConstantSoilMethod\nDeficitSoilMethod\nPotentialSoilMethod\nNoSoilMethod\nPhotosynthesis.soilmoisture_conductance","category":"page"},{"location":"#Photosynthesis.AbstractSoilMethod","page":"Home","title":"Photosynthesis.AbstractSoilMethod","text":"Methods for calculating the effect of soil moisture on stomatal conductance. \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.VolumetricSoilMethod","page":"Home","title":"Photosynthesis.VolumetricSoilMethod","text":"VolumetricSoilMethod(soildata, wc1, wc2, soilroot, soildepth)\n\nSoil method where soil water is handled volumetrically.\n\nField Default Units Description\nsoildata ContentSoilData{Float64,Float64}(0.0, 1. 1 \nwc1 0.5 1 \nwc2 0.5 1 \nsoilroot 0.5 1 \nsoildepth 0.5 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.ConstantSoilMethod","page":"Home","title":"Photosynthesis.ConstantSoilMethod","text":"Soil method where soil water is held constant.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.DeficitSoilMethod","page":"Home","title":"Photosynthesis.DeficitSoilMethod","text":"DeficitSoilMethod(soildata)\n\nSoil method where soil water is handled as a moisture deficit.\n\nField Default Units Description\nsoildata ContentSoilData{Float64,Float64}(0.0, 1. 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.PotentialSoilMethod","page":"Home","title":"Photosynthesis.PotentialSoilMethod","text":"PotentialSoilMethod(soildata, swpexp)\n\nSoil mmodel where soil water is measured as water potential.\n\nField Default Units Description\nswpexp 0.5 kPa^-1 Exponent for soil water-potential response of stomata\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.NoSoilMethod","page":"Home","title":"Photosynthesis.NoSoilMethod","text":"NoSoilMethod()\n\nNo soil method is used, soil moisture has no effect.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.soilmoisture_conductance","page":"Home","title":"Photosynthesis.soilmoisture_conductance","text":"soilmoisture_conductance(soilmethod::AbstractSoilMethod, vars)\n\nCalculate the effect of soil water content on stomatal conductance\n\nThese methods dispatch on AbstractSoilMethod or AbstractSoilData types.\n\n\n\n\n\n","category":"function"},{"location":"#Soil-Data","page":"Home","title":"Soil Data","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Kinds of soil water data used in DeficitSoilMethod and VolumetricSoilMethod.","category":"page"},{"location":"","page":"Home","title":"Home","text":"AbstractSoilData\nAbstractDeficitSoilData\nAbstractContentSoilData\nDeficitSoilData\nContentSoilData\nSimulatedSoilData","category":"page"},{"location":"#Photosynthesis.AbstractSoilData","page":"Home","title":"Photosynthesis.AbstractSoilData","text":"Abstract supertype for component to specify the source data for soil moisture.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.AbstractDeficitSoilData","page":"Home","title":"Photosynthesis.AbstractDeficitSoilData","text":"Soil water data is measure as moisture-deficit.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.AbstractContentSoilData","page":"Home","title":"Photosynthesis.AbstractContentSoilData","text":"Soil water data is measure by volumetric content.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.DeficitSoilData","page":"Home","title":"Photosynthesis.DeficitSoilData","text":"DeficitSoilData(smd1, smd2)\n\nSoil water is measured as deficit\n\nField Default Units Description\nsmd1 1.0 1 \nsmd2 1.0 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.ContentSoilData","page":"Home","title":"Photosynthesis.ContentSoilData","text":"ContentSoilData(swmin, swmax, smd1, smd2)\n\nSoil water is measured as volumetric content\n\nField Default Units Description\nswmin 0.0 1 \nswmax 1.0 1 \nsmd1 1.0 1 \nsmd2 1.0 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.SimulatedSoilData","page":"Home","title":"Photosynthesis.SimulatedSoilData","text":"SimulatedSoilData(swmin, swmax, smd1, smd2)\n\nSimulated soil volumetric content.\n\nField Default Units Description\nswmin 0.0 1 \nswmax 1.0 1 \nsmd1 1.0 1 \nsmd2 1.0 1 \n\n\n\n\n\n","category":"type"},{"location":"#EMAX-Model","page":"Home","title":"EMAX Model","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"EmaxEnergyBalance\nEmaxStomatalConductance\nEmaxSoilMethod\nEmaxVars","category":"page"},{"location":"#Photosynthesis.EmaxEnergyBalance","page":"Home","title":"Photosynthesis.EmaxEnergyBalance","text":"EmaxEnergyBalance(energy_balance_model, totsoilres, plantk)\n\nWrapper to FvCBEnergyBalance model, adding totsoilres and plantk parameters.\n\nField Default Units Description\nenergybalancemodel FvCBEnergyBalance{WangRadiationConductan 1 \ntotsoilres 0.5 m^2 MPa s mmol^-1 \nplantk 3.0 mmol m^-2 MPa^-1 s^-1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.EmaxStomatalConductance","page":"Home","title":"Photosynthesis.EmaxStomatalConductance","text":"EmaxStomatalConductance(BallBerryStomatalConductance(gsshape, g0, gs_submodel, soil_model)\n\nThe same options are available for specialised stomatal conducance, but using emax soil water methods.\n\nField Default Units Description\ngsshape HardMinimum() 1 \ng0 0.03 mol m^-2 s^-1 Stomatal leakiness (gs when photosynthesis is zero)\ngs_submodel BallBerryStomatalConductanceSubModel{Uni 1 \nsoil_model PotentialSoilMethod{Unitful.Quantity{Flo 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.EmaxSoilMethod","page":"Home","title":"Photosynthesis.EmaxSoilMethod","text":"EmaxSoilMethod(soilmethod, non_stomatal)\n\nEmax implementation of soil method\n\nField Default Units Description\nsoilmethod ConstantSoilMethod() 1 \nnon_stomatal ZhouPotentialDependence{Unitful.Quantity 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.EmaxVars","page":"Home","title":"Photosynthesis.EmaxVars","text":"EmaxVars()\n\nVarbles for Emax models\n\nField Default Units Description\nminleafwp 0.1 kPa \nemaxleaf 400.0 mmol m^-2 s^-1 \nktot 2.0 mmol m^-2 MPa^-1 s^-1 \npsil -111.0 kPa \ncs 400.0 μmol mol^-1 \nvpdleaf 0.8 kPa \nrhleaf 0.99 1 Only in Ball-Berry Stomatal Conductance\nfheat 0.0 W m^-2 \ngbhu 0.0 m mol Pa J^-1 s^-1 \ngbhf 0.0 m mol Pa J^-1 s^-1 \ngh 0.0 m mol Pa J^-1 s^-1 \ngbh 0.0 m mol Pa J^-1 s^-1 \ngv 0.0 m mol Pa J^-1 s^-1 \ngradn 0.0 mol m^-2 s^-1 \nlhv 0.0 J mol^-1 \net 0.0 mol m^-2 s^-1 \nslope 0.0 Pa K^-1 \ndecoup 0.0 1 \ngsdiva 0.0 mol μmol^-1 \nkm 0.0 μmol mol^-1 \nci 0.0 μmol mol^-1 \ngammastar 0.0 μmol mol^-1 \ngs 0.0 mol m^-2 s^-1 \ngsv 0.0 mol m^-2 s^-1 \ngbv 0.0 mol m^-2 s^-1 \njmax 0.0 μmol m^-2 s^-1 \nvcmax 0.0 μmol m^-2 s^-1 \nrd 0.0 μmol m^-2 s^-1 \nac 0.0 μmol m^-2 s^-1 \naleaf 0.0 μmol m^-2 s^-1 \nvj 0.0 μmol m^-2 s^-1 \naj 0.0 μmol m^-2 s^-1 \nfsoil 0.0 1 \ntair 298.15 K \nwindspeed 1.0 m s^-1 \npar 1143.75 μmol m^-2 s^-1 \nrnet 250.0 W m^-2 \nsoilmoist 0.2 1 \npressure 101.25 kPa \ntleaf 298.15 K \nswp -100.0 kPa \nswpshade -100.0 kPa \nvpd 0.5 kPa \nca 400.0 μmol mol^-1 \nrh 0.5 1 \n\n\n\n\n\n","category":"type"},{"location":"#Tuzet-Model","page":"Home","title":"Tuzet Model","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"TuzetEnergyBalance\nTuzetStomatalConductance\nTuzetStomatalConductanceSubModel\nTuzetVars\nPhotosynthesis.leaf_water_potential_finder\nPhotosynthesis.fpsil","category":"page"},{"location":"#Photosynthesis.TuzetEnergyBalance","page":"Home","title":"Photosynthesis.TuzetEnergyBalance","text":"TuzetEnergyBalance(energy_balance)\nTuzetEnergyBalance(; energy_balance)\n\nTuzet implementation of energy balance. Essentially just a wrapper that runs a standard FvCB energy balance, with Tuzet  stomatal conductance formulation and soil moisture routines in a root finder.\n\nField Default Units Description\nenergy_balance FvCBEnergyBalance{WangRadiationConductan 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.TuzetStomatalConductance","page":"Home","title":"Photosynthesis.TuzetStomatalConductance","text":"TuzetStomatalConductance(gs_submodel, soilmethod)\n\nTuzet stomatal conductance model.\n\nThis model is limited to using TuzetStomatalConductance and TuzetSoilMethods.\n\nField Default Units Description\ng0 0.03 mol m^-2 s^-1 Stomatal leakiness (gs when photosynthesis is zero)\ngs_submodel TuzetStomatalConductanceSubModel{Unitful 1 \nsoil_model PotentialSoilMethod{Unitful.Quantity{Flo 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.TuzetStomatalConductanceSubModel","page":"Home","title":"Photosynthesis.TuzetStomatalConductanceSubModel","text":"TuzetStomatalConductanceSubModel(gamma, g1)\n\nTuzet stomatal conductance formulation parameters. (modelgs = 5 in maestra)\n\nField Default Units Description\ngamma 0.0 μmol mol^-1 Gamma for all Ball-Berry type models\ng1 7.0 1 Slope parameter\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.TuzetVars","page":"Home","title":"Photosynthesis.TuzetVars","text":"TuzetVars()\n\nVariables object for Tuzet models.\n\nField Default Units Description\npsilin -999.0 kPa \npsiv -1.9 kPa \nsf 3.2 kPa^-1 \ncs 400.0 μmol mol^-1 \nvpdleaf 0.8 kPa \nrhleaf 0.99 1 Only in Ball-Berry Stomatal Conductance\nfheat 0.0 W m^-2 \ngbhu 0.0 m mol Pa J^-1 s^-1 \ngbhf 0.0 m mol Pa J^-1 s^-1 \ngh 0.0 m mol Pa J^-1 s^-1 \ngbh 0.0 m mol Pa J^-1 s^-1 \ngv 0.0 m mol Pa J^-1 s^-1 \ngradn 0.0 mol m^-2 s^-1 \nlhv 0.0 J mol^-1 \net 0.0 mol m^-2 s^-1 \nslope 0.0 Pa K^-1 \ndecoup 0.0 1 \ngsdiva 0.0 mol μmol^-1 \nkm 0.0 μmol mol^-1 \nci 0.0 μmol mol^-1 \ngammastar 0.0 μmol mol^-1 \ngs 0.0 mol m^-2 s^-1 \ngsv 0.0 mol m^-2 s^-1 \ngbv 0.0 mol m^-2 s^-1 \njmax 0.0 μmol m^-2 s^-1 \nvcmax 0.0 μmol m^-2 s^-1 \nrd 0.0 μmol m^-2 s^-1 \nac 0.0 μmol m^-2 s^-1 \naleaf 0.0 μmol m^-2 s^-1 \nvj 0.0 μmol m^-2 s^-1 \naj 0.0 μmol m^-2 s^-1 \nfsoil 0.0 1 \ntair 298.15 K \nwindspeed 1.0 m s^-1 \npar 1143.75 μmol m^-2 s^-1 \nrnet 250.0 W m^-2 \nsoilmoist 0.2 1 \npressure 101.25 kPa \ntleaf 298.15 K \nswp -100.0 kPa \nswpshade -100.0 kPa \nvpd 0.5 kPa \nca 400.0 μmol mol^-1 \nrh 0.5 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.leaf_water_potential_finder","page":"Home","title":"Photosynthesis.leaf_water_potential_finder","text":"leaf_water_potential_finder(p, v, psilin)\n\nPSIL finder. A wrapper function for the energy balance that returns the squared  difference in PSILIN and PSIL, for use in a root finder.\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.fpsil","page":"Home","title":"Photosynthesis.fpsil","text":"fpsil(psil, sf, psiv)\n\nTuzet et al. 2003 leaf water potential function\n\n\n\n\n\n","category":"function"},{"location":"#Jarvis-Model","page":"Home","title":"Jarvis Model","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"JarvisStomatalConductance\nPhotosynthesis.factor_conductance\nAbstractJarvisLight\nJarvisLight\nPhotosynthesis.light_factor\n\nAbstractJarvisTemp\nJarvisNoTemp\nJarvisTemp1\nJarvisTemp2\nPhotosynthesis.temp_factor\n\nAbstractJarvisCO2\nJarvisNoCO2\nJarvisLinearCO2\nJarvisNonlinearCO2\nPhotosynthesis.co2_factor\n\nAbstractJarvisVPD\nJarvisHyperbolicVPD\nJarvisLohammerVPD\nJarvisFractionDeficitVPD\nJarvisLinearDeclineVPD\nPhotosynthesis.vpd_factor","category":"page"},{"location":"#Photosynthesis.JarvisStomatalConductance","page":"Home","title":"Photosynthesis.JarvisStomatalConductance","text":"JarvisStomatalConductance(co2method, vpdmethod, lightmethod, tempmethod, g0, gsref, vmfd)\n\nJarvis stomatal conductance model.\n\nCombines factors from soilmethod, co2 method, vpdmethod and tempmethod to gain an overall stomatal conductance.\n\nField Default Units Description\nco2method JarvisNonlinearCO2{Unitful.Quantity{Floa 1 \nvpdmethod JarvisLohammerVPD{Unitful.Quantity{Float 1 \nlightmethod JarvisLight{Unitful.Quantity{Float64,𝐍 𝐋 1 \ntempmethod JarvisTemp2{Unitful.Quantity{Float64,𝚯,U 1 \ng0 1.0 mol m^-2 s^-1 \ngsref 1.0 mol m^-2 s^-1 \nvmfd 1.0 mmol mol^-1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.factor_conductance","page":"Home","title":"Photosynthesis.factor_conductance","text":"factor_conductance(m, v)\n\nCalculate stomatal conductance gs according to the Jarvis model m, given variables v.\n\nThis model calculates gs by multiplying together factors for several environmental variables: light, VPD, CO2 and temperature.\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.AbstractJarvisLight","page":"Home","title":"Photosynthesis.AbstractJarvisLight","text":"Jarvis light response factor formulations Run in light_factor methods.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisLight","page":"Home","title":"Photosynthesis.JarvisLight","text":"JarvisLight(i0)i0\n\nFactor response to incident radiation\n\nField Default Units Description\ni0 1.0 mol m^-2 s^-1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.light_factor","page":"Home","title":"Photosynthesis.light_factor","text":"light_factor(m::AbstractJarvisLight, v)\n\nCalculates the light related conductance factor.\n\nReturns a value between 0.0 and 1.0\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.AbstractJarvisTemp","page":"Home","title":"Photosynthesis.AbstractJarvisTemp","text":"Temperature response factor formulations Run in temp_factor methods.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisNoTemp","page":"Home","title":"Photosynthesis.JarvisNoTemp","text":"JarvisNoTemp()\n\nNo response to temperature in Jarvis stomatal conductance\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisTemp1","page":"Home","title":"Photosynthesis.JarvisTemp1","text":"JarvisTemp1(tmax, tref, t0)\n\nField Default Units Description\ntmax 313.15 K \ntref 298.15 K \nt0 273.15 K \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisTemp2","page":"Home","title":"Photosynthesis.JarvisTemp2","text":"JarvisTemp2(tmax, tref, t0)\n\nField Default Units Description\ntmax 313.15 K \ntref 298.15 K \nt0 273.15 K \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.temp_factor","page":"Home","title":"Photosynthesis.temp_factor","text":"temp_factor(m::AbstractJarvisLight, v)\n\nCalculates the temperature related conductance factor.\n\nReturns a value between 0.0 and 1.0\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.AbstractJarvisCO2","page":"Home","title":"Photosynthesis.AbstractJarvisCO2","text":"Jarvis CO2 response factor formulations. Run in co2_factor methods.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisNoCO2","page":"Home","title":"Photosynthesis.JarvisNoCO2","text":"JarvisNoCO2()\n\nNo influence from CO2 for Jarvis stomatal conductance\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisLinearCO2","page":"Home","title":"Photosynthesis.JarvisLinearCO2","text":"JarvisLinearDeclineVPD(gsja)\n\nLinear response to CO2 for Jarvis stomatal conductance\n\nField Default Units Description\ngsja 1.0 mol μmol^-1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisNonlinearCO2","page":"Home","title":"Photosynthesis.JarvisNonlinearCO2","text":"JarvisNonlinearCO2(gsjb)\n\nNon-linear response to CO2 for Jarvis stomatal conductance\n\nField Default Units Description\ngsjb 1.0 μmol mol^-1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.co2_factor","page":"Home","title":"Photosynthesis.co2_factor","text":"co2_factor(m::AbstractJarvisLight, v)\n\nCalculates the CO2 related conductance factor.\n\nReturns a value between 0.0 and 1.0\n\n\n\n\n\n","category":"function"},{"location":"#Photosynthesis.AbstractJarvisVPD","page":"Home","title":"Photosynthesis.AbstractJarvisVPD","text":"Vapour pressure deficit response-factor formulations Run in vpd_factor methods.\n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisHyperbolicVPD","page":"Home","title":"Photosynthesis.JarvisHyperbolicVPD","text":"JarvisHyperbolicVPD(vk1, vk2)\n\nHyperbolic decline with VPD. BRAY (ALEX BOSC) Parameters vk1 and vk2 are the dimensionless scalar and exponent.\n\nField Default Units Description\nvk1 1.0 1 \nvk2 1.0 1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisLohammerVPD","page":"Home","title":"Photosynthesis.JarvisLohammerVPD","text":"JarvisLohammerVPD(vpd1, vpd2)\n\nNon-linear Lohammer response to vapour pressure deficit. Parameters vpd1 and vpd2 are in Pascals.\n\nField Default Units Description\nvpd1 1.0 Pa \nvpd2 1.0 Pa \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisFractionDeficitVPD","page":"Home","title":"Photosynthesis.JarvisFractionDeficitVPD","text":"JarvisFractionDeficitVPD(vmdf0)\n\nMole fraction deficit MARK RAYMENT\n\nField Default Units Description\nvmfd0 1.0 mmol mol^-1 \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.JarvisLinearDeclineVPD","page":"Home","title":"Photosynthesis.JarvisLinearDeclineVPD","text":"JarvisLinearDeclineVPD(d0)\n\nLinear decline with VPD (VPD1, VPD2 in Pa) * GROMIT (TIM RANDLE)\n\nField Default Units Description\nd0 1.0 Pa \n\n\n\n\n\n","category":"type"},{"location":"#Photosynthesis.vpd_factor","page":"Home","title":"Photosynthesis.vpd_factor","text":"vpd_factor(m::AbstractJarvisLight, v)\n\nCalculates the vapour-pressure-deficit related conductance factor.\n\nReturns a value between 0.0 and 1.0\n\n\n\n\n\n","category":"function"}]
}
